name: Testing Code

on: [push]

jobs:

  TESTANDO_O_CODIGO: 
    runs-on: ubuntu-latest
    steps:
    
    # TESTING ADDRESS SANITIZER
      - uses: actions/checkout@v2
      #- name: Compiling with Address Sanitizer
        #run: |
          #clang -fsanitize=address -g teste.c -o teste
          #./teste
    
    # TESTING CODE QUALITY
      - name: Install clang tidy
        run: | 
          sudo apt-get update -y
          sudo apt-get install -y clang-tidy
        
      - name: running clang tidy # with checks readability, mordenize, hipperformace, performance
        run: |
          clang-tidy --fix --warnings-as-errors="*" --checks="read*,modern*,hicpp*,performance*" *.c
          

   # CREATE REPORT CODE QUALITY
      - name: running clang tidy # with checks readability, mordenize, hipperformace, performance
        if: ${{ failure() }}
        run: |
          clang-tidy --fix  --checks="read*,modern*,hicpp*,performance*" *.c > report_code_quality.txt
          
      - name: Upload artifact
        if: ${{ failure() }}      
      - uses: actions/upload-artifact@v2
        with:
          name: report_code_quality
          path: ./report_code_quality.txt
        
